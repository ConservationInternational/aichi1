geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.8)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.95)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.9)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
#Sort data for analysis - trends
trends_biodiv_wide<-spread(trends_df,country,rate)
head(trends_biodiv_wide)
trends_biodiv_wide<-trends_biodiv_wide[,c(4:251)]
head(trends_biodiv_wide)
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.9)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.5)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.75)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.95)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.9)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat <- trends_biodiv_wide %>%
correlate() %>%
shave(upper = TRUE) %>%            # (3)
stretch(na.rm = TRUE) %>%          # (4)
filter(r >= 0.8)
set.seed(1)
cor.graph <- as_tbl_graph(corMat, directed = FALSE)
ggraph(cor.graph) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
#Webhose-Baseline
webhose_df<-read.csv("WEBHOSE-BASELINE.csv")
head(webhose_df)
#Clean R memory
rm(list=ls())
#Set working directory
setwd("D:/OneDrive/Collaborations/Matthew Cooper/CI monitoring/Data")
#Load relevant packages for data extraction
library(tidyverse)
####Open data files
#Trends
trends_df<-read.csv("TRENDS.csv")
head(trends_df)
#Twitter-Baseline
twitter_df<-read.csv("TWITTER-BASELINE.csv")
head(twitter_df)
#Webhose-Baseline
webhose_df<-read.csv("WEBHOSE-BASELINE.csv")
head(webhose_df)
####Sort data for analysis
#Trends
trends_wide<-spread(trends_df,country,rate)
trends_wide<-trends_wide[,c(4:251)]
head(trends_biodiv_wide)
head(trends_wide)
#Twitter
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,3:6]
twitter_df
twitter_df<-twitter_df[,3,5:6]
twitter_wide<-spread(trends_df,country,perc)
twitter_wide<-spread(twitter_df,country,perc)
str(twitter_df)
#Twitter
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(3,5:6)]
#Twitter-Baseline
twitter_df<-read.csv("TWITTER-BASELINE.csv")
head(twitter_df)
#Twitter
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(3,5:6)]
twitter_wide<-spread(twitter_df,country,perc)
str(twitter_df)
str(trends_df)
str(trends_df)
str(twitter_df)
#Twitter
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(3,5:6)]
#Twitter-Baseline
twitter_df<-read.csv("TWITTER-BASELINE.csv")
head(twitter_df)
str(twitter_df)
#Twitter
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(3,5:6)]
twitter_wide<-spread(twitter_df,country,perc)
#Twitter-Baseline
twitter_df<-read.csv("TWITTER-BASELINE.csv")
head(twitter_df)
####Sort data for analysis
#Trends
trends_df$country<-as.character(trends_df$country)
trends_wide<-spread(trends_df,country,rate)
trends_wide<-trends_wide[,c(4:251)]
head(trends_wide)
#Twitter
twitter_df$country<-as.character(twitter_df$country)
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(3,5:6)]
twitter_wide<-spread(twitter_df,country,perc)
twitter_wide
twitter_df
#Twitter-Baseline
twitter_df<-read.csv("TWITTER-BASELINE.csv")
head(twitter_df)
str(twitter_df)
#Twitter
twitter_df$country<-as.character(twitter_df$country)
twitter_df<-twitter_df %>% group_by(country,month) %>% sum()
twitter_df<-ddply(twitter_df,.(country,month),summarize,any=sum(any),baseline=sum(baseline))
twitter_df<-twitter_df %>% group_by(country,month) %>% summarize(any=sum(any),baseline=sum(baseline))
twitter_df
twitter_df<-as.data.frame(twitter_df)
twitter_df
twitter_df$perc<-(twitter_df$any/twitter_df$baseline)*100
twitter_df<-twitter_df[,c(1:2,5)]
twitter_df
twitter_wide<-spread(twitter_df,country,perc)
twitter_wide<-trends_wide[,c(4:251)]
twitter_wide
twitter_df
twitter_df$perc[is.na(twitter_df$perc)]
twitter_df$perc[is.na(twitter_df$perc)]<-0
twitter_wide<-spread(twitter_df,country,perc)
twitter_wide<-trends_wide[,c(4:251)]
twitter_wide<-spread(twitter_df,country,perc)
twitter_wide
twitter_wide<-twitter_wide[,c(2:249)]
head(twitter_wide)
corMat_twitter <- twitter_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.8)
set.seed(1)
cor.graph_twitter <- as_tbl_graph(corMat_twitter, directed = FALSE)
ggraph(cor.graph_twitter) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat_twitter <- twitter_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.9)
set.seed(1)
cor.graph_twitter <- as_tbl_graph(corMat_twitter, directed = FALSE)
ggraph(cor.graph_twitter) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
#Webhose-Baseline
webhose_df<-read.csv("WEBHOSE-BASELINE.csv")
head(webhose_df)
#webhose
webhose_df$country<-as.character(webhose_df$country)
webhose_df<-webhose_df %>% group_by(country,month) %>% summarize(any=sum(any),baseline=sum(baseline))
webhose_df<-as.data.frame(webhose_df)
webhose_df$perc<-(webhose_df$any/webhose_df$baseline)*100
webhose_df<-webhose_df[,c(1:2,5)]
webhose_df$perc[is.na(webhose_df$perc)]<-0
webhose_wide<-spread(webhose_df,country,perc)
webhose_wide<-webhose_wide[,c(2:249)]
head(webhose_wide)
webhose_wide<-webhose_wide[,c(2:212)]
head(webhose_wide)
#Network analysis webhose
corMat_webhose <- webhose_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.9)
set.seed(1)
cor.graph_webhose <- as_tbl_graph(corMat_webhose, directed = FALSE)
ggraph(cor.graph_webhose) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
#Network analysis webhose
corMat_webhose <- webhose_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.95)
set.seed(1)
cor.graph_webhose <- as_tbl_graph(corMat_webhose, directed = FALSE)
ggraph(cor.graph_webhose) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
corMat_trends <- trends_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.8)
set.seed(1)
cor.graph_trends <- as_tbl_graph(corMat_trends, directed = FALSE)
ggraph(cor.graph_trends) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
#Network analysis Trends
library("qgraph")
corMat_trends <- trends_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.5)
set.seed(1)
cor.graph_trends <- as_tbl_graph(corMat_trends, directed = FALSE)
ggraph(cor.graph_trends) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = label), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = country), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
head(cor.graph_trends)
row.names(cor.graph_trends)
rownames(cor.graph_trends)
library("navdata")
data("phone.call2")
phone.net <- tbl_graph(
nodes = phone.call2$nodes,
edges = phone.call2$edges,
directed = TRUE
)
install.packages("navdata")
if(!require(devtools)) install.packages("devtools")
devtools::install_github("kassambara/navdata")
library("navdata")
data("phone.call2")
phone.net <- tbl_graph(
nodes = phone.call2$nodes,
edges = phone.call2$edges,
directed = TRUE
)
phone.net
data("phone.call2")
phone.call2
data("phone.call2")
cor.graph_trends
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
#Network analysis Trends
library("qgraph")
corMat_trends <- trends_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.3)
set.seed(1)
cor.graph_trends <- as_tbl_graph(corMat_trends, directed = FALSE)
ggraph(cor.graph_trends) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
corMat_trends <- trends_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.2)
set.seed(1)
cor.graph_trends <- as_tbl_graph(corMat_trends, directed = FALSE)
ggraph(cor.graph_trends) +
geom_edge_link() +
geom_node_point() +
geom_node_text(
aes(label = name), size = 3, repel = TRUE
) +
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
cor.graph_twitter %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
#Network analysis twitter
corMat_twitter <- twitter_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.2)
#Network analysis twitter
corMat_twitter <- twitter_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.2)
set.seed(1)
cor.graph_twitter <- as_tbl_graph(corMat_twitter, directed = FALSE)
cor.graph_twitter %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
#Network analysis webhose
corMat_webhose <- webhose_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.5)
set.seed(1)
#Network analysis webhose
corMat_webhose <- webhose_wide %>%
correlate() %>%
shave(upper = TRUE) %>%
stretch(na.rm = TRUE) %>%
filter(r >= 0.5)
set.seed(1)
cor.graph_webhose <- as_tbl_graph(corMat_webhose, directed = FALSE)
cor.graph_webhose %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
cor.graph_trends %>%
activate(nodes) %>%
mutate(centrality = centrality_authority()) %>%
ggraph(layout = "graphopt") +
geom_edge_link(width = 1, colour = "lightgray") +
geom_node_point(aes(size = centrality, colour = centrality)) +
geom_node_text(aes(label = name), repel = TRUE)+
scale_color_gradient(low = "yellow", high = "red")+
theme_graph()
